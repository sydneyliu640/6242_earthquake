<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Earthquake</title>

    <!-- Bootstrap Core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Earthquake</a>
            </div>
            <!-- /.navbar-header -->

            
            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        
                        <li>
                            <a href="index.html"><i class="fa fa-dashboard fa-fw"></i> Dashboard</a>
                        </li>
                        <li>
                            <a href="chart.html"><i class="fa fa-bar-chart-o fa-fw"></i> Charts</a>
                        </li>
                        <li>
                            <a href="download.html"><i class="fa fa-download fa-fw"></i> Data</a>
                        </li>
                        <li>
                            <a href="forecast.html"><i class="fa fa-edit fa-fw"></i> Forecast</a>
                        </li>
                        <li>
                            <a href="map.html"><i class="fa fa-map-marker fa-fw"></i> Map</a>
                        </li>
                        
                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">Loss Forecast</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Try the model
                        </div>
                        <div class="panel-body">
                            <form id = "forms" role="form">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label>Earthquake Intensity</label>
                                        <input class="form-control" placeholder="Enter number" value="6">
                                    </div>
                                    <div class="form-group">
                                        <label>Earthquake Depth</label>
                                        <input class="form-control" placeholder="Enter number" value="6">
                                    </div>
                                    <div class="form-group">
                                        <label>Population</label>
                                        <input class="form-control" placeholder="Enter number" value="10000">
                                    </div>
                                    <div class="form-group">
                                        <label>Average Income ($ per month)</label>
                                        <input class="form-control" placeholder="Enter number" value="8000">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label># of Hospital</label>
                                        <input class="form-control" placeholder="Enter number" value="30">
                                    </div>
                                    <div class="form-group">
                                        <label># of Bed</label>
                                        <input class="form-control" placeholder="Enter number" value="200">
                                    </div>
                                    <div class="form-group">
                                        <label>Rating of Hospital</label>
                                        <input class="form-control" placeholder="Enter number" value="3.5">
                                    </div>
                                    
                                    
                                </div>
                                
                                <button type="button" class="btn btn-outline btn-primary btn-lg btn-block" onclick="report()">Launch Model</button>
                            </form>
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-12 -->
                <div class="col-lg-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Analysis of regression models
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <!-- Nav tabs -->
                            <ul class="nav nav-pills">
                                <li class="active"><a href="#Linear-pills" data-toggle="tab">Linear Regression</a>
                                </li>
                                <li><a href="#Neural-pills" data-toggle="tab">Neural Network</a>
                                </li>
                                <li><a href="#Support-pills" data-toggle="tab">Support Vector Machine</a>
                                </li>

                            </ul>

                            <!-- Tab panes -->
                            <div class="tab-content">
                                <div class="tab-pane fade in active" id="Linear-pills">
                                    <h4>Linear Regression</h4>
                                    <img src="../pics/Linear_Regression.png", style="width:400px;height:280px;">
                                    <p>In our linear regression model, we consider both robust regression and ridge regressionï¼Œbecause there are some missing value in the original data(since in some year, some counties only have one or two times of earthquake, then loss could be very small or even missing), so robust regression could avoid this problem. Since sumEnergy could be very large, we also use ridge regression to balance square error and absolute error, we finally get a more reasonable linear regression model and evaluate each of the parameter, the result shows income and medical situation in county level could be very influential on economic loss, since in most cases, the earthquake intensity are under 7 degree, which will not cause much building destroying.</p>
                                </div>
                                <div class="tab-pane fade" id="Neural-pills">
                                    <h4>Neural Network</h4>
                                    <img src="../pics/Neural_Network.png", style="width:400px;height:228px;">
                                    <p>In our Neural Network construction, we use two hidden layer, first hidden layer has 9 neurons and the second has 2 neurons, we train our model by using backpropagation algorithm. After tunning our model, we finnally determine parameters in neural network: learning rate is 0.7(which can also be tuned in the trainning procedure by model itself), using "Tanh" function as activation function, and using entrophy function as loss function. We also preclassify our loss test data into 5 classes, and tested result in our trained network, the result shows we can reach 85% accuracy, and confusion matrix presents relative incorrectly classified instances.</p>
                                </div>
                                <div class="tab-pane fade" id="Support-pills">
                                    <h4>Support Vector Machine</h4>
                                    <img src="../pics/Support_Vector_Machine.png", style="width:400px;height:300px;">
                                    <p>We use support vector machine to do regression of our data, support vector machine is very specific class of algorithm, characterized by usage of kernels, absence of local minima, sparseness of the solution and capacity control obtained by acting on the margin, or on number of support vectors. In our experiment, we choose gaussian kernel, specific meta-parameters parameters C, and epsilon. We evaluate the performance of two most import attributes: County income and total number of earthquakes, which confirm its influence on loss. We also tune the svm result by factors' importance. The figure shows the importance of income and total number of earthquakes.</p>
                                </div>
                            </div>
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <div class="col-lg-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            Analysis of classification models
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <!-- Nav tabs -->
                            <ul class="nav nav-pills">
                                <li class="active"><a href="#Random-pills" data-toggle="tab">Random Forest</a>
                                </li>
                                <li><a href="#Decision-pills" data-toggle="tab">Decision Tree</a>
                                </li>
                                <li><a href="#Nearest-pills" data-toggle="tab">K-Nearest Neighbors</a>
                                </li>
                                <li><a href="#Naive-pills" data-toggle="tab">Naive Bayes</a>
                                </li>

                            </ul>

                            <!-- Tab panes -->
                            <div class="tab-content">
                                <div class="tab-pane fade in active" id="Random-pills">
                                    <h4>Random Forest</h4>
                                    <img src="../pics/Random_Forest.jpeg", style="width:400px;height:228px;">
                                    <p>In our Random Forest model, with different configuration of model we have tried on our dataset, we have finally tuned to model to the following parameter setup: Use 100 trees while each tree uses three features, and each tree has a max depth of one. This model results in the highest accuracy among all our models when running on our dataset with 10 fold cross validation, which is as high as 96.5%.  As shown in the confusion matrix, the result has a weighted average true positive rate as 96.5% and false positive rate as 1.2%.</p>
                                </div>
                                <div class="tab-pane fade" id="Decision-pills">
                                    <h4>Decision Tree</h4>
                                    <img src="../pics/Decision_Tree.jpeg", style="width:400px;height:228px;">
                                    <p>In our Decision Tree model, we used the technique of maximizing information gain to shorten our tree. And we set the confidence factor as 0.25 to prune our tree model. When running our model on our dataset with 10 fold cross validation, we get result of fairly high accuracy. As shown in the confusion matrix, the result has a weighted average true positive rate as 93.1% and false positive rate as 2.5%.</p>
                                </div>
                                <div class="tab-pane fade" id="Nearest-pills">
                                    <h4>K-Nearest Neighbors</h4>
                                    <img src="../pics/Nearest_Neighbors.jpeg", style="width:400px;height:228px;">
                                    <p>In our k Nearest Neighbor model, we have tried building the model with various k value to test on our dataset, and find that the test with 10 folds cross validation has the highest accuracy when k equals one. And for the nearest neighbor search algorithm we used the linear nearest neighbor search model, with euclidean distance specifically. One biggest advantage of kNN is it builds the model very fast, while the accuracy is nearly as good as the tree models, whose building time is longer than the kNN. As shown in the result, the kNN model's accuracy is 94%.</p>
                                </div>
                                <div class="tab-pane fade" id="Naive-pills">
                                    <h4>Naive Bayes</h4>
                                    <img src="../pics/Naive_Bayes.jpeg", style="width:400px;height:228px;">
                                    <p>Naive Bayse is a very simple but strong classifier. It performs pretty good on some dataset. But for our dataset, the 10 folds cross validation testing accuracy is relatively low comparing to other classifier modelsï¼Œwhich is only 64.67%. And as shown in the confusion matrix, the true weighted average positive rate is 64.7%, and false positive rate is 12.5%.</p>
                                </div>
                            </div>
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
            </div>
            <!-- /.row -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="../vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../vendor/metisMenu/metisMenu.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/sb-admin-2.js"></script>

    <script>
    function report() {
        var text = "";
        var x = document.getElementById("forms");
        var a_inter = -2.784e4 - 5.781;
        var a_rating = -6.21e3;
        var a_bed = -8.867e1;
        var a_hosp = 8.226e3;
        var a_income = 1.198;
        var a_population = 9.929e-2;
        var a_energy = 4.379e-19;
        var a_mag = 3.45;
        var a_dep = -2.073e2;

        var mag = parseFloat(x.elements[0].value);
        var energy = Math.pow(10,11.8+1.5*mag);
        var dep = parseFloat(x.elements[1].value);
        var population = parseFloat(x.elements[2].value);
        var income = parseFloat(x.elements[3].value);
        var hosp = parseFloat(x.elements[4].value);
        var bed = parseFloat(x.elements[5].value);
        var rating = parseFloat(x.elements[6].value);

        var loss = a_inter + a_rating*rating + a_bed*bed + a_hosp*hosp + a_income*income + a_population*population + a_energy*energy + a_mag*mag + a_dep*dep;

        text = "The estimated loss of this earthquake is $" + parseInt(loss);
        alert(text);
    }
</script>



</body>

</html>
